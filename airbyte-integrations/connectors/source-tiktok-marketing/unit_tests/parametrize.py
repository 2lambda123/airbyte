#
# Copyright (c) 2022 Airbyte, Inc., all rights reserved.
#

import pytest

advertisers_before = {
    "name": "Airbyte0827",
    "promotion_area": "0",
    "status": "STATUS_LIMIT",
    "country": "RU",
    "timezone": "Europe/Moscow",
    "telephone_number": "+18023****63",
    "rejection_reason": '1:Dear customer,\nWe\'ve detected that your account has not been logged into for a long period of time, which could cause a security risk. In order to improve platform security, your account has been temporarily suspended. For further information or if you have any questions, please submit a ticket under "Account Review" in the Business Support Center to raise an appeal.\nThank you for your understanding.\n,endtime:2031-12-31 07:32:13',
    "address": None,
    "currency": "RUB",
    "license_url": None,
    "role": "ROLE_ADVERTISER",
    "display_timezone": "Europe/Moscow",
    "license_no": None,
    "description": None,
    "email": "i***************@**********",
    "language": "",
    "license_city": None,
    "brand": None,
    "cellphone_number": "+18023****63",
    "industry": "291905",
    "create_time": 1630055520,
    "promotion_center_city": None,
    "balance": 0,
    "license_province": None,
    "advertiser_id": "7001035076276387841",
    "contacter": "Ai***te",
    "company": "Airbyte",
    "promotion_center_province": None,
}
advertisers_after = {
    "name": "Airbyte0827",
    "promotion_area": "0",
    "status": "STATUS_LIMIT",
    "country": "RU",
    "timezone": "Europe/Moscow",
    "telephone_number": "+18023****63",
    "address": None,
    "currency": "RUB",
    "license_url": None,
    "role": "ROLE_ADVERTISER",
    "display_timezone": "Europe/Moscow",
    "license_no": None,
    "description": None,
    "email": "i***************@**********",
    "language": "",
    "license_city": None,
    "brand": None,
    "industry": "291905",
    "create_time": 1630055520,
    "promotion_center_city": None,
    "balance": 0,
    "license_province": None,
    "contacter": "Ai***te",
    "company": "Airbyte",
    "promotion_center_province": None,
    "reason": '1:Dear customer,\nWe\'ve detected that your account has not been logged into for a long period of time, which could cause a security risk. In order to improve platform security, your account has been temporarily suspended. For further information or if you have any questions, please submit a ticket under "Account Review" in the Business Support Center to raise an appeal.\nThank you for your understanding.\n,endtime:2031-12-31 07:32:13',
    "phonenumber": "+18023****63",
    "id": 7001035076276387841,
}

ads_before = {
    "display_name": "Airbyte",
    "creative_authorized": True,
    "avatar_icon_web_uri": "",
    "impression_tracking_url": None,
    "deeplink": "",
    "page_id": None,
    "ad_id": 1714073085256738,
    "landing_page_url": "https://airbyte.io",
    "call_to_action": "READ_MORE",
    "is_new_structure": True,
    "video_id": "v10033g50000c5ngl53c77ubdn0nprqg",
    "vast_moat_enabled": False,
    "card_id": None,
    "brand_safety_postbid_partner": "UNSET",
    "ad_texts": None,
    "create_time": "2021-10-19 18:18:09",
    "adgroup_id": 1714073022392322,
    "operation_status": "DISABLE",
    "ad_format": "SINGLE_VIDEO",
    "ad_name": "Optimized Version 1_202110192111_2021-10-19 21:11:39",
    "ad_text": "Open Source ETL",
    "image_ids": ["v0201/d25dc9be82074c848949be13effd5bbd"],
    "landing_page_urls": None,
    "click_tracking_url": None,
    "identity_type": "UNSET",
    "is_aco": False,
    "app_name": "",
    "creative_type": None,
    "fallback_type": "UNSET",
    "profile_image_url": "",
    "modify_time": "2021-10-20 08:05:14",
    "identity_id": "",
    "adgroup_name": "Ad Group20211019111040",
    "call_to_action_id": None,
    "optimization_event": None,
    "secondary_status": "AD_STATUS_CAMPAIGN_DISABLE",
    "playable_url": "",
    "advertiser_id": 7002238017842757633,
    "campaign_id": 1714073078669329,
    "deeplink_type": "NORMAL",
    "campaign_name": "Website Traffic20211019110444",
}
ads_after = {
    "display_name": "Airbyte",
    "avatar_icon_web_uri": "",
    "impression_tracking_url": None,
    "page_id": None,
    "landing_page_url": "https://airbyte.io",
    "call_to_action": "READ_MORE",
    "is_new_structure": True,
    "video_id": "v10033g50000c5ngl53c77ubdn0nprqg",
    "brand_safety_postbid_partner": "UNSET",
    "ad_texts": None,
    "create_time": "2021-10-19 18:18:09",
    "ad_format": "SINGLE_VIDEO",
    "ad_name": "Optimized Version 1_202110192111_2021-10-19 21:11:39",
    "ad_text": "Open Source ETL",
    "image_ids": ["v0201/d25dc9be82074c848949be13effd5bbd"],
    "landing_page_urls": None,
    "click_tracking_url": None,
    "identity_type": "UNSET",
    "is_aco": False,
    "app_name": "",
    "creative_type": None,
    "fallback_type": "UNSET",
    "modify_time": "2021-10-20 08:05:14",
    "identity_id": "",
    "adgroup_name": "Ad Group20211019111040",
    "call_to_action_id": None,
    "optimization_event": None,
    "playable_url": "",
    "campaign_name": "Website Traffic20211019110444",
    "premium_badge_id": None,
    "tracking_pixel_id": None,
    "status": "AD_STATUS_CAMPAIGN_DISABLE",
    "opt_status": "DISABLE",
    "profile_image": "",
    "open_url": "",
    "open_url_type": "NORMAL",
    "vast_moat": False,
    "is_creative_authorized": True,
    "advertiser_id": 7002238017842757633,
    "campaign_id": 1714073078669329,
    "adgroup_id": 1714073022392322,
    "ad_id": 1714073085256738,
    "card_id": None,
}

ad_groups_before = {
    "device_price_ranges": [],
    "comment_disabled": False,
    "is_hfss": False,
    "create_time": "2021-10-19 18:18:09",
    "modify_time": "2021-10-20 08:05:14",
    "purchased_reach": None,
    "rf_estimated_frequency": None,
    "campaign_id": 1714073078669329,
    "secondary_optimization_event": None,
    "operating_systems": [],
    "deep_cpa_bid": 0.0,
    "placements": None,
    "bid_type": "BID_TYPE_NO_BID",
    "included_custom_actions": [],
    "brand_safety_partner": None,
    "app_download_url": None,
    "keywords": None,
    "actions": [],
    "promotion_type": "WEBSITE",
    "purchased_impression": None,
    "delivery_mode": None,
    "budget": 50,
    "gender": "GENDER_MALE",
    "app_id": None,
    "location_ids": ["5332921"],
    "pixel_id": None,
    "search_result_enabled": False,
    "frequency": None,
    "statistic_type": None,
    "audience_ids": [],
    "frequency_schedule": None,
    "app_type": None,
    "budget_mode": "BUDGET_MODE_DAY",
    "excluded_custom_actions": [],
    "conversion_window": None,
    "brand_safety_type": "NO_BRAND_SAFETY",
    "network_types": [],
    "split_test_adgroup_ids": [],
    "bid_display_mode": "CPMV",
    "campaign_name": "Website Traffic20211019110444",
    "dayparting": "000000000000000000000000011111111111111110000000000000000000000000000000011111110000000000000000000000000000000000000000011111111111111110000000000000000000000000000000011111111111111110000000000000000000000000000000001111111111111110000000000000000000000000000000011111111111111110000000000000000000000000000000011111111111111110000000",
    "optimization_event": None,
    "age_groups": ["AGE_25_34", "AGE_35_44", "AGE_45_54"],
    "deep_bid_type": None,
    "auto_targeting_enabled": False,
    "pacing": "PACING_MODE_SMOOTH",
    "rf_estimated_cpr": None,
    "adgroup_name": "Ad Group20211019111040",
    "scheduled_budget": 0.0,
    "skip_learning_phase": 0,
    "schedule_start_time": "2021-10-19 19:10:40",
    "rf_purchased_type": None,
    "device_model_ids": [],
    "feed_type": None,
    "advertiser_id": 7002238017842757633,
    "category_id": "0",
    "placement_type": "PLACEMENT_TYPE_AUTOMATIC",
    "share_disabled": False,
    "schedule_type": "SCHEDULE_START_END",
    "optimization_goal": "CLICK",
    "interest_keyword_ids": [],
    "video_download_disabled": False,
    "billing_event": "CPC",
    "next_day_retention": None,
    "ios14_quota_type": "UNOCCUPIED",
    "excluded_audience_ids": [],
    "operation_status": "DISABLE",
    "schedule_infos": None,
    "is_new_structure": True,
    "inventory_filter_enabled": False,
    "creative_material_mode": "CUSTOM",
    "secondary_status": "ADGROUP_STATUS_CAMPAIGN_DISABLE",
    "conversion_bid_price": 0.0,
    "schedule_end_time": "2021-11-24 19:10:40",
    "languages": ["en"],
    "bid_price": 0.0,
    "interest_category_ids": [],
    "adgroup_id": 1714073022392322,
}
ad_groups_after = {
    "is_hfss": False,
    "create_time": "2021-10-19 18:18:09",
    "modify_time": "2021-10-20 08:05:14",
    "bid_type": "BID_TYPE_NO_BID",
    "brand_safety_partner": None,
    "app_download_url": None,
    "keywords": None,
    "budget": 50,
    "gender": "GENDER_MALE",
    "search_result_enabled": False,
    "frequency": None,
    "statistic_type": None,
    "frequency_schedule": None,
    "app_type": None,
    "budget_mode": "BUDGET_MODE_DAY",
    "conversion_window": None,
    "split_test_adgroup_ids": [],
    "bid_display_mode": "CPMV",
    "campaign_name": "Website Traffic20211019110444",
    "dayparting": "000000000000000000000000011111111111111110000000000000000000000000000000011111110000000000000000000000000000000000000000011111111111111110000000000000000000000000000000011111111111111110000000000000000000000000000000001111111111111110000000000000000000000000000000011111111111111110000000000000000000000000000000011111111111111110000000",
    "deep_bid_type": None,
    "pacing": "PACING_MODE_SMOOTH",
    "adgroup_name": "Ad Group20211019111040",
    "scheduled_budget": 0.0,
    "schedule_start_time": "2021-10-19 19:10:40",
    "feed_type": None,
    "category_id": "0",
    "placement_type": "PLACEMENT_TYPE_AUTOMATIC",
    "schedule_type": "SCHEDULE_START_END",
    "billing_event": "CPC",
    "ios14_quota_type": "UNOCCUPIED",
    "schedule_infos": None,
    "is_new_structure": True,
    "creative_material_mode": "CUSTOM",
    "schedule_end_time": "2021-11-24 19:10:40",
    "languages": ["en"],
    "carriers": None,
    "is_share_disable": False,
    "placement": None,
    "enable_inventory_filter": False,
    "external_type": "WEBSITE",
    "external_action": None,
    "deep_external_action": None,
    "age": ["AGE_25_34", "AGE_35_44", "AGE_45_54"],
    "operation_system": [],
    "connection_type": [],
    "device_price": [],
    "optimize_goal": "CLICK",
    "bid": 0.0,
    "conversion_bid": 0.0,
    "deep_cpabid": 0.0,
    "daily_retention_ratio": None,
    "status": "ADGROUP_STATUS_CAMPAIGN_DISABLE",
    "opt_status": "DISABLE",
    "action_v2": [],
    "rf_buy_type": None,
    "buy_impression": None,
    "buy_reach": None,
    "rf_predict_cpr": None,
    "rf_predict_frequency": None,
    "include_custom_actions": [],
    "exclude_custom_actions": [],
    "brand_safety": "NO_BRAND_SAFETY",
    "display_mode": None,
    "is_comment_disable": 0,
    "audience": [],
    "excluded_audience": [],
    "location": [5332921],
    "interest_category_v2": [],
    "interest_keywords": [],
    "device_models": [],
    "video_download": "False",
    "automated_targeting": "False",
    "advertiser_id": 7002238017842757633,
    "campaign_id": 1714073078669329,
    "adgroup_id": 1714073022392322,
    "app_id": None,
    "pixel_id": None,
    "skip_learning_phase": 0,
}

campaigns_before = {
    "deep_bid_type": None,
    "roas_bid": 0.0,
    "create_time": "2021-10-19 18:18:08",
    "objective_type": "TRAFFIC",
    "campaign_name": "Website Traffic20211019110444",
    "operation_status": "DISABLE",
    "modify_time": "2022-03-28 12:01:56",
    "budget_mode": "BUDGET_MODE_DAY",
    "campaign_type": "REGULAR_CAMPAIGN",
    "advertiser_id": 7002238017842757633,
    "secondary_status": "CAMPAIGN_STATUS_DISABLE",
    "objective": "LANDING_PAGE",
    "budget": 50,
    "split_test_variable": None,
    "campaign_id": 1714073078669329,
    "is_new_structure": True,
}
campaigns_after = {
    "deep_bid_type": None,
    "roas_bid": 0.0,
    "create_time": "2021-10-19 18:18:08",
    "objective_type": "TRAFFIC",
    "campaign_name": "Website Traffic20211019110444",
    "modify_time": "2022-03-28 12:01:56",
    "budget_mode": "BUDGET_MODE_DAY",
    "campaign_type": "REGULAR_CAMPAIGN",
    "objective": "LANDING_PAGE",
    "budget": 50,
    "split_test_variable": None,
    "campaign_id": 1714073078669329,
    "is_new_structure": True,
    "opt_status": "DISABLE",
    "status": "CAMPAIGN_STATUS_DISABLE",
    "advertiser_id": 7002238017842757633,
}

report_before = {
    "metrics": {
        "video_watched_2s": "474",
        "video_watched_6s": "141",
        "result_rate": 1.33,
        "real_time_result_rate": 1.33,
        "impressions": 4874,
        "average_video_play": "1.45",
        "real_time_app_install": "0",
        "dpa_target_audience_type": None,
        "real_time_cost_per_conversion": 0,
        "cost_per_result": 0.3077,
        "likes": "52",
        "video_views_p75": "116",
        "secondary_goal_result": None,
        "result": 65,
        "cost_per_conversion": 0,
        "real_time_app_install_cost": "0.0",
        "real_time_conversion_rate": 0,
        "placement_type": "Automatic Placement",
        "conversion": 0,
        "app_install": "0",
        "clicks_on_music_disc": "0",
        "shares": "0",
        "real_time_result": 65,
        "video_views_p50": "170",
        "conversion_rate": 0,
        "video_play_actions": "4293",
        "mobile_app_id": "0",
        "real_time_conversion": 0,
        "frequency": 1.21,
        "secondary_goal_result_rate": None,
        "tt_app_name": "0",
        "comments": "0",
        "real_time_cost_per_result": 0.3077,
        "cost_per_secondary_goal_result": None,
        "spend": 20,
        "profile_visits": "0",
        "average_video_play_per_user": "1.55",
        "cpc": 0.31,
        "cost_per_1000_reached": 4.971,
        "reach": 4023,
        "cpm": 4.1,
        "adgroup_name": "Ad Group20211019111040",
        "video_views_p100": "80",
        "tt_app_id": 0,
        "clicks": 65,
        "promotion_type": "Website",
        "video_views_p25": "349",
        "follows": "0",
        "ctr": 1.33,
        "campaign_id": 1714073078669329,
        "campaign_name": "Website Traffic20211019110444",
    },
    "dimensions": {"stat_time_day": "2021-10-19 00:00:00", "adgroup_id": 1714073022392322},
}
report_after = {
    "metrics": {
        "video_watched_2s": "474",
        "video_watched_6s": "141",
        "result_rate": 1.33,
        "real_time_result_rate": 1.33,
        "impressions": 4874,
        "average_video_play": "1.45",
        "real_time_app_install": "0",
        "dpa_target_audience_type": None,
        "real_time_cost_per_conversion": 0,
        "cost_per_result": 0.3077,
        "likes": "52",
        "video_views_p75": "116",
        "secondary_goal_result": None,
        "result": 65,
        "cost_per_conversion": 0,
        "real_time_app_install_cost": "0.0",
        "real_time_conversion_rate": 0,
        "conversion": 0,
        "app_install": "0",
        "clicks_on_music_disc": "0",
        "shares": "0",
        "real_time_result": 65,
        "video_views_p50": "170",
        "conversion_rate": 0,
        "video_play_actions": "4293",
        "mobile_app_id": "0",
        "real_time_conversion": 0,
        "frequency": 1.21,
        "secondary_goal_result_rate": None,
        "tt_app_name": "0",
        "comments": "0",
        "real_time_cost_per_result": 0.3077,
        "cost_per_secondary_goal_result": None,
        "spend": 20,
        "profile_visits": "0",
        "average_video_play_per_user": "1.55",
        "cpc": 0.31,
        "cost_per_1000_reached": 4.971,
        "reach": 4023,
        "cpm": 4.1,
        "adgroup_name": "Ad Group20211019111040",
        "video_views_p100": "80",
        "tt_app_id": 0,
        "clicks": 65,
        "promotion_type": "Website",
        "video_views_p25": "349",
        "follows": "0",
        "ctr": 1.33,
        "campaign_name": "Website Traffic20211019110444",
        "placement": "Automatic Placement",
        "campaign_id": 1714073078669329,
    },
    "dimensions": {"stat_time_day": "2021-10-19 00:00:00", "adgroup_id": 1714073022392322},
}


api_response_parameters = pytest.mark.parametrize(
    "record_before, record_after, stream_name, endpoint_path",
    (
        (advertisers_before, advertisers_after, "advertisers", "advertiser/info/"),
        (ads_before, ads_after, "ads", "ad/get/"),
        (ad_groups_before, ad_groups_after, "ad_groups", "adgroup/get/"),
        (campaigns_before, campaigns_after, "campaigns", "campaign/get/"),
        (report_before, report_after, "ad_groups_reports_daily", "report/integrated/get/"),
    ),
)
