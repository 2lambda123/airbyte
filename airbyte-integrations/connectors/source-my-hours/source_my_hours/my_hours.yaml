page_size: 50

schema_loader:
  type: JsonSchema
  file_path: "./source_my_hours/schemas/{{ options.name }}.json"
selector:
  type: RecordSelector
  extractor:
    type: JelloExtractor
    transform: "_"
requester:
  type: HttpRequester
  name: "{{ options['name'] }}"
  url_base: "https://api2.myhours.com/api"
  http_method: "GET"
  authenticator:
    class_name: "source_my_hours.auth.MyHoursAuthenticator"
    email: "{{ config.email }}"
    password: "{{ config.password }}"
  request_options_provider:
    request_headers:
      accept: "application/json"
      api-version: "1.0"
      Content-Type: "application/json"
retriever:
  type: SimpleRetriever
  name: "{{ options['name'] }}"
  primary_key: "{{ options['primary_key'] }}"
stream_slicer:
  type: "DatetimeStreamSlicer"
  start_datetime:
    datetime: "2017-01-01T00:00:00.0Z"
    datetime_format: "%Y-%m-%dT%H:%M:%S.%f%z"
  end_datetime:
    datetime: "2022-08-01T00:00:00.0Z"
    datetime_format: "%Y-%m-%dT%H:%M:%S.%f%z"
  step: "10000d"
  cursor_field: "created"
  start_time_option:
    field_name: "start_time"
    inject_into: "request_parameter"
  end_time_option:
    field_name: "end_time"
    inject_into: "request_parameter"
  datetime_format: "timestamp"
clients_stream:
  type: DeclarativeStream
  $options:
    name: "clients"
  primary_key: "id"
  schema_loader:
    $ref: "*ref(schema_loader)"
  retriever:
    $ref: "*ref(retriever)"
    record_selector:
      $ref: "*ref(selector)"
    requester:
      $ref: "*ref(requester)"
      path: "/api/Clients"
    paginator:
      type: "NoPagination"
projects_stream:
  type: DeclarativeStream
  $options:
    name: "projects"
  primary_key: "id"
  schema_loader:
    $ref: "*ref(schema_loader)"
  retriever:
    $ref: "*ref(retriever)"
    record_selector:
      $ref: "*ref(selector)"
    requester:
      $ref: "*ref(requester)"
      path: "/api/Projects/getAll"
    paginator:
      type: "NoPagination"
streams:
  - "*ref(clients_stream)"
  - "*ref(projects_stream)"
check:
  type: CheckStream
  stream_names: ["clients"]
